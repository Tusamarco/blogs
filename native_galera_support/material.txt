

ysql: [Warning] Using a password on the command line interface can be insecure.
mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1380	|
| 10000  | 100       | 192.168.4.23  | 3306     | SHUNNED | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1328	|
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1155	|
| 10000  | 102       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1328	|
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1155	|
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+

+----------+----------------------+--------------------------+
| username | frontend_connections | frontend_max_connections |
+----------+----------------------+--------------------------+
| app_test | 0                    | 10000                    |
| dba	   | 0                    | 10000                    |
+----------+----------------------+--------------------------+
mysql: [Warning] Using a password on the command line interface can be insecure.
+---------------+------+------------------+-----------------+-------------------+-----------+------------------------+-------------------+--------------+----------------------+---------------------------------+----------------+-------+
| hostname	| port | time_start_us    | success_time_us | primary_partition | read_only | wsrep_local_recv_queue | wsrep_local_state | wsrep_desync | wsrep_reject_queries | wsrep_sst_donor_rejects_queries | pxc_maint_mode | error |
+---------------+------+------------------+-----------------+-------------------+-----------+------------------------+-------------------+--------------+----------------------+---------------------------------+----------------+-------+
| 192.168.4.233 | 3306 | 1604057214442207 | 6345            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.23  | 3306 | 1604057214439134 | 6303            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.22  | 3306 | 1604057214432484 | 8622            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.22  | 3306 | 1604057214431937 | 6112            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.233 | 3306 | 1604057209443643 | 5671            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.23  | 3306 | 1604057209438839 | 5668            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.22  | 3306 | 1604057209433362 | 9083            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.22  | 3306 | 1604057209431669 | 5965            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.233 | 3306 | 1604057204422482 | 6394            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
| 192.168.4.23  | 3306 | 1604057204421315 | 5941            | YES               | NO        | 0                      | 4                 | NO           | NO                   | NO                              | NO             | NULL  |
+---------------+------+------------------+-----------------+-------------------+-----------+------------------------+-------------------+--------------+----------------------+---------------------------------+----------------+-----

MySQL_HostGroups_Manager.cpp:4715:update_galera_set_writer(): [WARNING] Galera: setting host 192.168.4.23:3306 as writer
MySQL_HostGroups_Manager.cpp:1271:commit(): [WARNING] Removed server at address 140342347271968, hostgroup 101, address 192.168.4.23 port 3306. Setting status OFFLINE HARD and immediately dropping all free connections. Used connections will be dropped when trying to use them


mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1524       |
| 10000  | 100       | 192.168.4.23  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1177       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1466       |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1177       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1466       |
| 10000  | 102       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0      | 0	| 0           | 0	| 0                 | 0               | 0               | 1177       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0	| 0           | 0	| 0                 | 0               | 0               | 1466       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+


mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | ONLINE  | 0        | 50	| 50     | 0	   | 50          | 82747   | 0                 | 6615964         | 0               | 1332	|
| 10000  | 9101      | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1282	|
| 10000  | 9101      | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1165	|
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+


mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1254       |
| 10000  | 100       | 192.168.4.23  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1261       |
| 10000  | 101       | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1254       |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0      | 0	| 0           | 0	| 0                 | 0               | 0               | 1261       |
| 10000  | 102       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0      | 0	| 0           | 0	| 0                 | 0               | 0               | 1261       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+


+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1282	|
| 10000  | 100       | 192.168.4.23  | 3306     | SHUNNED | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1066	|
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1050	|
| 10000  | 101       | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1282	|
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1066	|
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1050	|
| 10000  | 102       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1066	|
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1050	|
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+



mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 4263       |
| 10000  | 101       | 192.168.4.233 | 3306     | ONLINE  | 46       | 4        | 50     | 0       | 50          | 4419225 | 0                 | 312794035       | 407292480       | 4263       |
| 10000  | 9101      | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 2122       |
| 10000  | 9101      | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 2092       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+



PXC Maint
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | ONLINE  | 50       | 0        | 50     | 0       | 50          | 61181   | 0                 | 4143057         | 2845229         | 2008       |
| 10000  | 100       | 192.168.4.23  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1590       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 2060       |
| 10000  | 101       | 192.168.4.233 | 3306     | ONLINE  | 5        | 45       | 50     | 0       | 50          | 6311160 | 0                 | 446710134       | 581743822       | 2008       |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 3        | 20       | 23     | 0       | 23          | 24328   | 0                 | 1721815         | 2273509         | 1590       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 3        | 34       | 37     | 0       | 37          | 1104285 | 0                 | 78158575        | 101602254       | 2060       |
| 10000  | 102       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1590       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0	| 0           | 0	| 0                 | 0               | 0               | 2060       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
+---------------+---------+--------------------+-----------------+

mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 50       | 0        | 50     | 0	   | 50          | 472855  | 0                 | 32136742        | 22940595        | 1863	|
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0	     | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1697	|
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0	     | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1913	|
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 16       | 15	    | 31     | 0	   | 31          | 204436  | 0                 | 14469685        | 19546010        | 1697	|
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 4        | 33	    | 37     | 0	   | 37          | 1244759 | 0                 | 88101023        | 115331025	   | 1913	|
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0	     | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1913	|
| 10000  | 9101      | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0	     | 0	   | 0           | 0	   | 0                 | 0               | 0               | 1863	|
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
....
mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 50       | 0        | 50     | 0	   | 50          | 940858  | 0                 | 63990470        | 47264196        | 3604	|
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0	     | 0	   | 0           | 0	   | 0                 | 0               | 0               | 2444	|
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0	     | 0	   | 0           | 0	   | 0                 | 0               | 0               | 2353	|
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 11       | 20	    | 31     | 0	   | 31          | 458546  | 0                 | 32451091        | 45259022        | 2444	|
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 7        | 30	    | 37     | 0	   | 37          | 1426114 | 0                 | 100942743       | 134070389	   | 2353	|
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0	     | 0	   | 0           | 0	   | 0                 | 0               | 0               | 2353	|
| 10000  | 9101      | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0	     | 0	   | 0           | 0	   | 0                 | 0               | 0               | 3604	|
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+


(root@localhost) [(none)]>show global variables like 'pxc%';
+-----------------------------+-------------+
| Variable_name               | Value       |
+-----------------------------+-------------+
| pxc_encrypt_cluster_traffic | OFF         |
| pxc_maint_mode              | MAINTENANCE |
| pxc_maint_transition_period | 10          |
| pxc_strict_mode             | ENFORCING   |
+-----------------------------+-------------+
4 rows in set (0.01 sec)


+--------+-----------+---------------+----------+---------+----------+---------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | Queries |
+--------+-----------+---------------+----------+---------+----------+---------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 50       | 472855  |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0	   |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0	   |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 16       | 204436  |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 4        | 1244759 |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0	   |
| 10000  | 9101      | 192.168.4.233 | 3306     | ONLINE  | 0        | 0	   |
+--------+-----------+---------------+----------+---------+----------+---------+
....
+--------+-----------+---------------+----------+---------+----------+---------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | Queries |
+--------+-----------+---------------+----------+---------+----------+---------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 50       | 940858  |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0	   |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0	   |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 11       | 458546  |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 7        | 1426114 |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0	   |
| 10000  | 9101      | 192.168.4.233 | 3306     | ONLINE  | 0        | 0	   |
+--------+-----------+---------------+----------+---------+----------+---------+


+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 1        | 0        | 111    | 0       | 50          | 3065154 | 0                 | 208421964       | 171344867       | 2668       |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 49       | 0        | 49     | 0       | 49          | 78219   | 0                 | 5298725         | 4857403         | 3365       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 3611       |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 3        | 27       | 34     | 0       | 34          | 1565411 | 0                 | 110781805       | 171847997       | 3365       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 1        | 35       | 37     | 0       | 37          | 2233657 | 0                 | 158105947       | 227419384       | 3611       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 3611       |
| 10000  | 9101      | 192.168.4.233 | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 2668       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+

159,50,69.95,7699.61,7230.94,226.84,241.83,1170.65,0.00,1.00
160,50,69.84,7291.20,6842.24,220.49,228.47,1479.41,0.00,2.00
161,50,59.98,7722.29,7235.47,217.92,268.91,1453.01,0.00,1.00
162,50,77.00,7444.48,6962.45,251.02,231.01,926.33,0.00,0.00
163,50,51.17,6757.11,6353.79,198.65,204.67,1506.29,0.00,2.01
164,50,70.77,7367.43,6895.94,232.26,239.23,1258.08,0.00,2.99
165,50,59.13,6961.16,6529.22,218.48,213.46,1191.92,0.00,2.00
166,50,1.00,3002.42,2988.45,5.99,7.98,746.32,0.00,49.89       <-------- Start
167,50,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00
168,50,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00
169,50,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00
170,50,0.00,2848.58,2548.73,174.91,124.94,0.00,0.00,0.00     
171,50,0.00,0.00,0.00,0.00,0.00,0.00,0.00,0.00
172,50,49.97,2413.33,2306.40,16.99,89.94,7346.49,0.00,0.00   <------- failover 
173,50,38.13,6012.14,5653.88,159.56,198.70,877.61,0.00,1.00
174,50,53.00,6137.30,5768.28,188.01,181.01,1561.52,0.00,1.00
175,50,63.74,5972.01,5570.62,209.16,192.23,1304.21,0.00,0.00
176,50,61.10,6218.05,5817.40,210.34,190.31,1376.60,0.00,1.00
177,50,49.97,5970.94,5597.13,172.91,200.90,1170.65,0.00,1.00
178,50,54.14,6014.88,5652.92,185.49,176.47,1304.21,0.00,0.00
179,50,55.92,6228.86,5828.44,199.71,200.71,1352.03,0.00,1.00
180,50,52.96,5963.57,5595.85,181.87,185.86,1235.62,0.00,1.00
181,50,51.08,6076.52,5706.94,179.28,190.30,1280.93,0.00,1.00
182,50,58.87,6312.26,5908.14,204.55,199.57,1401.61,0.00,0.00
183,50,59.02,6843.56,6431.40,203.08,209.08,1506.29,0.00,3.00
184,50,56.15,6626.57,6185.40,219.58,221.59,1648.20,0.00,0.00
185,50,61.96,6492.86,6089.12,197.87,205.87,1258.08,0.00,3.00
186,50,60.88,6654.45,6252.27,202.59,199.59,1089.30,0.00,1.00
187,50,57.17,6586.89,6173.64,187.57,225.68,1427.08,0.00,0.00


mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | ONLINE  | 50       | 0        | 211    | 60      | 50          | 4637293 | 0                 | 315060712       | 275785905       | 1666       |
| 10000  | 100       | 192.168.4.23  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 2533       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 47     | 0       | 47          | 77758   | 0                 | 5270185         | 5292400         | 1818       |
| 10000  | 101       | 192.168.4.233 | 3306     | ONLINE  | 4        | 19       | 42     | 84      | 23          | 466659  | 0                 | 33023429        | 60552411        | 1666       |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 4        | 13       | 17     | 0       | 17          | 11634   | 0                 | 823665          | 1581045         | 2533       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 6        | 30       | 37     | 0	| 37          | 2975221 | 0                 | 210594441       | 323622784	| 1818       |
| 10000  | 102       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0	   | 0                 | 0               | 0               | 2533       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0	| 0           | 0	| 0                 | 0               | 0               | 1818       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
+---------------+---------+------------------+-----------------+


mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 0        | 0        | 211    | 110     | 50          | 4811296 | 0                 | 326864073       | 287806209       | 2885       |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 10       | 0        | 10     | 0       | 10          | 7332    | 0                 | 496096          | 503510          | 1822       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 40       | 0        | 87     | 0       | 47          | 96762   | 0                 | 6554562         | 6579128         | 2800       |
| 10000  | 101       | 192.168.4.233 | 3306     | SHUNNED | 0        | 0        | 42     | 103     | 23          | 523073  | 0                 | 37016349        | 68083642        | 2885       |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 3        | 21       | 24     | 0       | 24          | 79034   | 0                 | 5594433         | 10807638        | 1822       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 12       | 24       | 37     | 0       | 37          | 3039359 | 0                 | 215134501       | 332394552       | 2800       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 0          |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+

mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 0        | 0        | 211    | 116     | 50          | 4811296 | 0                 | 326864073       | 287806209       | 3165       |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 37       | 0        | 37     | 0       | 37          | 47037   | 0                 | 3186964         | 3228710         | 1755       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 13       | 0        | 87     | 0       | 47          | 141310  | 0                 | 9576096         | 9689170         | 3641       |
| 10000  | 101       | 192.168.4.233 | 3306     | SHUNNED | 0        | 0        | 42     | 123     | 23          | 523073  | 0                 | 37016349        | 68083642        | 3165       |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 7        | 17       | 24     | 0       | 24          | 114467  | 0                 | 8101480         | 15561525        | 1755       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 12       | 24       | 37     | 0       | 37          | 3082585 | 0                 | 218195631       | 338337411       | 3641       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 3641       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+

mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 0        | 0        | 211    | 116     | 50          | 4811296 | 0                 | 326864073       | 287806209       | 3165       |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 49       | 1        | 50     | 0       | 50          | 152722  | 0                 | 10353993        | 10555658        | 2281       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 87     | 0       | 47          | 145618  | 0                 | 9869277         | 10002007        | 2764       |
| 10000  | 101       | 192.168.4.233 | 3306     | SHUNNED | 0        | 0        | 42     | 155     | 23          | 523073  | 0                 | 37016349        | 68083642        | 3165       |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 10       | 14       | 24     | 0       | 24          | 156241  | 0                 | 11056796        | 21331229        | 2281       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 10       | 26       | 37     | 0       | 37          | 3143112 | 0                 | 222481994       | 346591580       | 2764       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 2764       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+



+--------+-----------+---------------+----------+---------+----------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed |
+--------+-----------+---------------+----------+---------+----------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 0        |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 10       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 40       |
| 10000  | 101       | 192.168.4.233 | 3306     | SHUNNED | 0        |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 3        |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 12       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        |
+--------+-----------+---------------+----------+---------+----------+
...
+--------+-----------+---------------+----------+---------+----------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed |
+--------+-----------+---------------+----------+---------+----------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 0        |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 37       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 13       |
| 10000  | 101       | 192.168.4.233 | 3306     | SHUNNED | 0        |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 7        |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 12       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        |
+--------+-----------+---------------+----------+---------+----------+
...
+--------+-----------+---------------+----------+---------+----------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed |
+--------+-----------+---------------+----------+---------+----------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 0        |
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 49       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        |
| 10000  | 101       | 192.168.4.233 | 3306     | SHUNNED | 0        |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 10       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 10       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        |
+--------+-----------+---------------+----------+---------+----------+

mysql: [Warning] Using a password on the command line interface can be insecure.
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.233 | 3306     | SHUNNED | 0        | 0        | 211    | 146     | 50          | 4811296 | 0                 | 326864073       | 287806209       | 3165       |
| 10000  | 100       | 192.168.4.22  | 3306     | ONLINE  | 50       | 0        | 137    | 0       | 50          | 191985  | 0                 | 13007252        | 13229167        | 2908       |
| 10000  | 101       | 192.168.4.233 | 3306     | SHUNNED | 0        | 0        | 42     | 261     | 23          | 523073  | 0                 | 37016349        | 68083642        | 3165       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 16       | 33       | 50     | 0       | 49          | 3384241 | 0                 | 239548424       | 379833266       | 2908       |
| 10000  | 9101      | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0       | 0                 | 0               | 0               | 1295       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+---------+-------------------+-----------------+-----------------+------------+


+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+----------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries  | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+----------+-------------------+-----------------+-----------------+------------+
| 10000  | 100       | 192.168.4.23  | 3306     | ONLINE  | 686      | 0        | 1158   | 0       | 720         | 89765    | 0                 | 6036035         | 6717940         | 4832       |
| 10000  | 100       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0        | 245    | 13974   | 716         | 28420    | 0                 | 1921943         | 2353244         | 7291       |
| 10000  | 101       | 192.168.4.233 | 3306     | ONLINE  | 62       | 228      | 290    | 0       | 290         | 2783     | 0                 | 199775          | 619542          | 383473     |
| 10000  | 101       | 192.168.4.23  | 3306     | ONLINE  | 43       | 178      | 507    | 8183    | 320         | 11334922 | 0                 | 802274302       | 1812510983      | 4832       |
| 10000  | 101       | 192.168.4.22  | 3306     | ONLINE  | 19       | 181      | 232    | 5292    | 202         | 7634196  | 0                 | 540305082       | 1223732864      | 7291       |
| 10000  | 102       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 0      | 0       | 0           | 0        | 0                 | 0               | 0               | 7291       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+----------+-------------------+-----------------+-----------------+------------+

l> select * from mysql_servers ;
+--------------+---------------+------+-----------+--------+--------+-------------+-----------------+---------------------+---------+----------------+---------+
| hostgroup_id | hostname      | port | gtid_port | status | weight | compression | max_connections | max_replication_lag | use_ssl | max_latency_ms | comment |
+--------------+---------------+------+-----------+--------+--------+-------------+-----------------+---------------------+---------+----------------+---------+
| 100          | 192.168.4.22  | 3306 | 0         | ONLINE | 10000  | 0           | 2000            | 0                   | 0       | 0              | DC1     |
| 101          | 192.168.4.22  | 3306 | 0         | ONLINE | 10000  | 0           | 2000            | 0                   | 0       | 0              | DC1     |
| 101          | 192.168.4.23  | 3306 | 0         | ONLINE | 100    | 0           | 2000            | 0                   | 0       | 0              | DC1     |
| 101          | 192.168.4.233 | 3306 | 0         | ONLINE | 10000  | 0           | 2000            | 0                   | 0       | 0              | DC1     |
+--------------+---------------+------+-----------+--------+--------+-------------+-----------------+---------------------+---------+----------------+---------+
4 rows in set (0.00 sec)

+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+----------+-------------------+-----------------+-----------------+------------+
| weight | hostgroup | srv_host      | srv_port | status  | ConnUsed | ConnFree | ConnOK | ConnERR | MaxConnUsed | Queries  | Queries_GTID_sync | Bytes_data_sent | Bytes_data_recv | Latency_us |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+----------+-------------------+-----------------+-----------------+------------+
| 100    | 100       | 192.168.4.23  | 3306     | SHUNNED | 0        | 0        | 0      | 0       | 0           | 0        | 0                 | 0               | 0               | 1515       |
| 10000  | 100       | 192.168.4.22  | 3306     | ONLINE  | 0        | 0        | 245    | 13974   | 716         | 28420    | 0                 | 1921943         | 2353244         | 1160       |
| 10000  | 101       | 192.168.4.233 | 3306     | ONLINE  | 718      | 2        | 1117   | 0       | 720         | 68652    | 0                 | 4860000         | 11408447        | 429024     |
| 100    | 101       | 192.168.4.23  | 3306     | ONLINE  | 0        | 200      | 606    | 8183    | 320         | 12303565 | 0                 | 870827439       | 1970275653      | 1515       |
| 10000  | 101       | 192.168.4.22  | 3306     | SHUNNED | 0        | 0  	| 232    | 5453    | 282         | 8327148  | 0                 | 589339729	  | 1335992228      | 1160 	 |
| 100    | 102       | 192.168.4.23  | 3306     | ONLINE  | 0        | 0        | 0	 | 0	   | 0           | 0        | 0                 | 0               | 0               | 1515       |
+--------+-----------+---------------+----------+---------+----------+----------+--------+---------+-------------+----------+-------------------+-----------------+-----------------+------------+




20-11-02 08:55:00 [INFO] MySQL_HostGroups_Manager::commit() locked for 3ms
2020-11-02 08:55:00 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 809ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 08:55:00 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f752760a380 , MYSQL 0x7f7518a9b900 , FD 861 : timeout check
2020-11-02 08:55:55 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 812ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 08:55:55 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f752760ae00 , MYSQL 0x7f75240d6900 , FD 1071 : timeout check
2020-11-02 08:58:00 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 804ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 08:58:00 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f7527609480 , MYSQL 0x7f7518a9b900 , FD 1270 : timeout check
2020-11-02 09:03:30 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 808ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 09:03:30 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f7527609780 , MYSQL 0x7f751d32fc00 , FD 499 : timeout check
2020-11-02 09:03:55 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 801ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 09:03:55 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f752760aa40 , MYSQL 0x7f751d32f700 , FD 157 : timeout check
2020-11-02 09:04:50 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 801ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 09:04:50 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f752760be80 , MYSQL 0x7f751d32f700 , FD 48 : timeout check
2020-11-02 09:06:40 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 805ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 09:06:40 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f752760b580 , MYSQL 0x7f75240d6900 , FD 48 : timeout check
2020-11-02 09:06:46 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 801ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 09:06:46 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f752760a800 , MYSQL 0x7f75244c0200 , FD 2258 : timeout check
2020-11-02 09:07:01 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 800ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 09:07:01 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f7527609e40 , MYSQL 0x7f75244c0200 , FD 2259 : timeout check
2020-11-02 09:07:51 MySQL_Monitor.cpp:1591:monitor_galera_thread(): [ERROR] Timeout on Galera health check for 192.168.4.23:3306 after 801ms. If the server is overload, increase mysql-monitor_galera_healthcheck_timeout.
2020-11-02 09:07:51 MySQL_Monitor.cpp:1845:monitor_galera_thread(): [ERROR] Got error. mmsd 0x7f7527609b40 , MYSQL 0x7f75240d6900 , FD 48 : timeout check


===================================================================================================
Marco Script
===================================================================================================

git clone https://github.com/Tusamarco/proxy_sql_tools.git

chmod +x /opt/tools/proxy_sql_tools/galera_check.pl

Set the host group servers:
  
delete from mysql_servers where hostgroup_id in (8100,8101);
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('192.168.4.22',8100,3306,1000,2000,'Failover server preferred');
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('192.168.4.23',8100,3306,999,2000,'Second preferred');    
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('192.168.4.233',8100,3306,998,2000,'Thirdh and last in the list');      
    
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('192.168.4.22',8101,3306,1000,2000,'');
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('192.168.4.23',8101,3306,1000,2000,'');    
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('192.168.4.233',8101,3306,1000,2000,'');      


LOAD MYSQL SERVERS TO RUNTIME; SAVE MYSQL SERVERS TO DISK;



delete from scheduler where id=10;
INSERT  INTO scheduler (id,active,interval_ms,filename,arg1) values (10,0,2000,"/opt/tools/proxy_sql_tools/galera_check.pl","-u=cluster1 -p=clusterpass -h=192.168.4.191 -H=100:W,101:R -P=6032 --retry_down=2 --retry_up=1 --main_segment=2 --debug=0  --log=/var/lib/proxysql/galeraLog --active_failover=1");

INSERT  INTO scheduler (id,active,interval_ms,filename,arg1) values (10,0,2000,"/opt/tools/proxy_sql_tools/galera_check.pl","-u=cluster1 -p=clusterpass -h=192.168.4.191/2/3 -H=100:W,101:R -P=6032  --main_segment=2 --debug=0  --log=/var/lib/proxysql/galeraLog --active_failover=1");

update scheduler set active=1 where id=10;
load scheduler to runtime;

LOAD SCHEDULER TO RUNTIME;SAVE SCHEDULER TO DISK;


to monitor:
----------
watch -n 1 'mysql -h 192.168.4.191 -P 6032 -ucluster1 -pclusterpass -t -e "select b.weight, c.* from stats_mysql_connection_pool c left JOIN runtime_mysql_servers b ON  c.hostgroup=b.hostgroup_id and c.srv_host=b.hostname and c.srv_port = b.port  where hostgroup in (100,101,102,8100,8101,9100,9101) order by hostgroup,srv_host desc;" -e " select srv_host,command,avg(time_ms), count(ThreadID) from stats_mysql_processlist group by srv_host,command;" -e "select * from stats_mysql_users;";mysql -h 192.168.4.191 -P 6032 -ucluster1 -pclusterpass -t -e " select * from mysql_server_galera_log  order by time_start_us desc limit 10"'












===================================================================================================
Percona Script
===================================================================================================
Percona script CANNOT handle different ips between proxysql and internal node exchange 

delete from mysql_servers where hostgroup_id in (200,201);
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('10.0.0.22',200,3306,10000,2000,'DC1');
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('10.0.0.22',201,3306,100,2000,'DC1');
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('10.0.0.23',201,3306,10000,2000,'DC1');    
INSERT INTO mysql_servers (hostname,hostgroup_id,port,weight,max_connections,comment) VALUES ('10.0.0.33',201,3306,10000,2000,'DC1');        

load mysql servers to run;save mysql servers to disk;

git clone https://github.com/Percona-Lab/proxysql-scheduler.git

Usage: ${path##*/} "--config-file=/etc/proxysql-admin-sample.cnf --writer-is-reader=always --write-hg=200 --read-hg=201 --writer-count=1 --priority=10.0.0.22:3306,10.0.0.23:3306,10.0.0.33:3306 --mode=singlewrite --log=/var/lib/proxysql/pxc_test_proxysql_galera_check.log --debug"


delete from scheduler where id=60;
INSERT  INTO scheduler (id,active,interval_ms,filename,arg1) values (60,0,3000,"/opt/tools/proxysql-scheduler/proxysql_galera_checker","--config-file=/opt/tools/proxysql-scheduler/proxysql-admin-sample.cnf --writer-is-reader=always --write-hg=200 --read-hg=201 --writer-count=1 --priority=10.0.0.22:3306,10.0.0.23:3306,10.0.0.33:3306 --mode=singlewrite --debug --log=/tmp/pxc_test_proxysql_galera_check.log");
LOAD SCHEDULER TO RUNTIME;SAVE SCHEDULER TO DISK;

update scheduler set active=1 where id=60;
load scheduler to runtime;





